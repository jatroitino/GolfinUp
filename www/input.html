<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <meta name="format-detection" content="telephone=no" />
    <meta name="msapplication-tap-highlight" content="no" />
    <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width" />
    <!-- This is a wide open CSP declaration. To lock this down for production, see below. -->
    <meta http-equiv="Content-Security-Policy" content="default-src * 'unsafe-inline'; style-src 'self' 'unsafe-inline'; media-src *" />
    <!-- Good default declaration:
    * gap: is required only on iOS (when using UIWebView) and is needed for JS->native communication
    * https://ssl.gstatic.com is required only on Android and is needed for TalkBack to function properly
    * Disables use of eval() and inline scripts in order to mitigate risk of XSS vulnerabilities. To change this:
        * Enable inline JS: add 'unsafe-inline' to default-src
        * Enable eval(): add 'unsafe-eval' to default-src
    * Create your own at http://cspisawesome.com
    -->
    <!-- <meta http-equiv="Content-Security-Policy" content="default-src 'self' data: gap: 'unsafe-inline' https://ssl.gstatic.com; style-src 'self' 'unsafe-inline'; media-src *" /> -->

    <link rel="stylesheet" type="text/css" href="css/bootstrap.min.css" />
    <link rel="stylesheet" type="text/css" href="css/index.css" />
    <title>GolfinUp</title>
</head>

<body id="input">
    <div class="app conatiner">
		<div class="row">
			<div class="col-1"></div>
			<div class="col-10">
				<div class="row no-gutters pinfo">
					<div class="col-8">Course:&nbsp;<span id="course"></span></div>
					<div class="col-2">Hole:&nbsp;<span id="hole"></span></div>
					<div class="col-2">Par:&nbsp;<span id="spar"></span></div>
				</div>
				<h2><img src="img/icono-hoyo-peque-o.svg" />   Stroke <span></span><em></em></h2>
				<div class="row  no-gutters">
					<div class="col-8">
						Distance to hole:
					</div>
					<div class="col-4 pdist">
						<input tabindex="1" type="number" name="distance" id="distance" class="form-control" placeholder="meters"/>
					</div>
				</div>
				<div class="row  no-gutters s2">
					<div class="col-3">
						Lie:
					</div>
					<div class="col-9">
						<select tabindex="2" class="form-control"  name="lie" id="lie">
							<option value="Teeing">Tee</option>
							<option value="Fairway">Fairway</option>
							<option value="Rough">Rough</option>
							<option value="Bunker">Bunker</option>
							<option value="Green">Green</option>
							<option value="Other">Other </option>
						</select>
					</div>
				</div>
				<div class="row  no-gutters s3">
					<div class="col-3">
						Club:
					</div>
					<div class="col-9">
						<select tabindex="3" class="form-control"  name="club" id="club">
							<option>Driver</option>
							<option>Wood 2</option>
							<option>Wood 3</option>
							<option>Wood 4</option>
							<option>Wood 5</option>
							<option>Wood 6</option>
							<option>Wood 7</option>
							<option>Wood 8</option>
							<option>Wood 9</option>
							<option>Wood 10</option>
							<option>Wood 11</option>
							<option>Iron 1</option>
							<option>Iron 2</option>
							<option>Iron 3</option>
							<option>Iron 4</option>
							<option>Iron 5</option>
							<option>Iron 6</option>
							<option>Iron 7</option>
							<option>Iron 8</option>
							<option>Iron 9</option>
							<option>Pitching wedge</option>
							<option>Gap wedge</option>
							<option>Sand wedge</option>
							<option>Lob wedge</option>
							<option>Ultra lob wedge</option>
							<option>Putter</option>
						</select>
					</div>
				</div>
				<div class="row  no-gutters s4">
					<div class="col-9">
						Impeded shot:
					</div>
					<div class="col-3">
						<input tabindex="4" type="checkbox" name="prevented" id="prevented" class="form-control form-control-lg">
					</div>
				</div>
				<div class="row  no-gutters s5">
					<div class="col-9">
						Penalty shot:
					</div>
					<div class="col-3">
						<select tabindex="5" name="penalty" id="penalty" class="form-control form-control-sm">
							<option></option>
							<option>1</option>
							<option>2</option>
						</select>
					</div>
				</div>
				<div class="row  no-gutters s6" style="margin-bottom:0">
					<div class="col-12">
						<a href="" id="gimme" class="btn btn-secondary btn-lg">Gimme</a>
					</div>
				</div>

			</div>
			<div class="col-1"></div>
			
			</div>
			<div class="row wp">
			<div class="col-3 sp">
				<a href="" id="endround" class="btn btn-danger">Finish round</a>
			</div>
			<div class="col-2 sp">
				<a href="" id="toholes" class="btn btn-info">Menu</a>
			</div>
			<div class="col-3 sp">
				<a href="" id="endhole" class="btn btn-info">Next hole</a>
			</div>
			<div class="col-2 sp">
				<a href="" id="prevstrike" class="btn btn-info"><</a>
			</div>
			<div class="col-2 sp">
				<a href="" id="nextstrike" class="btn btn-info">></a>
			</div>
			</div>
		</div>
    </div>
<footer class="fixed-bottom">
	<div class="container-fluid">
		<div class="col-3">
			<a href="home.html">
				<img src="img/home_inactive.svg"><br>Dashboard
			</a>
		</div>
		<div class="col-3 active">
			<a href="play.html">
				<img src="img/input.svg"><br>Input
			</a>
		</div>
		<div class="col-3">
			<a href="stats.html">
				<img src="img/stats_inactive.svg"><br>Stats
			</a>
		</div>
		<div class="col-3">
			<a href="ajustes.html">
				<img src="img/ajustes_inactive.svg"><br>Config.
			</a>
		</div>
	</div>
</footer>

<div class="modal" id="modal1" tabindex="-1" role="dialog">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <p>Has it been ball holed or lifted?</p>
      </div>
      <div class="modal-footer">
        <button type="button" id="bholed" class="btn btn-primary">Holed</button>
        <button type="button" id="blifted" class="btn btn-primary">Lifted</button>
      </div>
    </div>
  </div>
</div>

<div class="modal" id="modalpar" tabindex="-1" role="dialog">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-body">
        <p>Par:</p>
		
		<select class="form-control form-control-sm" id="par">
							<option value="">-</option>
							<option value="3">3</option>
							<option value="4">4</option>
							<option value="5">5</option>
		</select>
						
      </div>
    </div>
  </div>
</div>

<div class="modal" id="modal2" tabindex="-1" role="dialog">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-body">
        <p>2nd shot in par 5:</p>
					
      </div>
	   <div class="modal-footer">
        <button type="button" id="sd1" class="btn btn-info"> Going for the green</button>
        <button type="button" id="sd2" class="btn btn-info">Laying up</button>
      </div>
    </div>
  </div>
</div>

    <script type="text/javascript" src="cordova.js"></script>
    <script type="text/javascript" src="https://unpkg.com/popper.js"></script>
    <script type="text/javascript" src="js/jquery.min.js"></script>
    <script type="text/javascript" src="js/bootstrap.min.js"></script>
    <script type="text/javascript" src="js/bootstrap3-typeahead.min.js"></script>
    <script type="text/javascript" src="js/index.js"></script>
    <script type="text/javascript">
        app.initialize();
		var unitT;
		var unitT2;
		$(document).ready(function(){
			var units = window.localStorage.getItem("units");
			if (units == 'yards'){
				unitT = 0.9144;
				unitT2 = 1.0936;
			} else {
				unitT = 1;
				unitT2 = 1;
			}
			
			var strike = parseInt(window.localStorage.getItem("strike"));
			if (!(strike > 0)){
				strike = 1;
			}
			if (strike == 1){
				$('#prevstrike').hide();
				$('#gimme').hide();
				window.localStorage.setItem("par",0);
				$("#modalpar").modal({show: true,keyboard: false,backdrop: 'static'});
				
				$('#lie').empty().append($('<option>', {value: 'Teeing',text: 'Tee'})).attr('readonly','readonly');
					
			} else {
				$('#lie').val(window.localStorage.getItem("lie"));
			}

			var par = window.localStorage.getItem("par");


			if (strike == 2 && par == 5){
				$("#modal2").modal({show: true,keyboard: false,backdrop: 'static'});
			}
			
			/*if (par > 0){
				$('#par').val(par);
			} */
			
			window.localStorage.setItem("strike", strike);
			if (window.localStorage.getItem("holes") == null){
				var holes = new Array();
			} else {
				var holes = JSON.parse(window.localStorage.getItem("holes"));
			}
			holes[window.localStorage.getItem("shole")] = 1;
			window.localStorage.setItem("holes", JSON.stringify(holes));
			$('#course').html(window.localStorage.getItem("course"));
			$('#hole').html(window.localStorage.getItem("shole"));
			$('#spar').html(window.localStorage.getItem("par"));
			$('#tour').html(window.localStorage.getItem("tour"));
			$('h2 span').html(window.localStorage.getItem("strike"));
			pstrike = parseInt(window.localStorage.getItem("pstrike"));
			if (pstrike > 0){
				$('h2 em').html('+'+pstrike);
			} else {
				window.localStorage.setItem("pstrike",0);
			}
			
			$('#club').val(window.localStorage.getItem("club"));
			shole = window.localStorage.getItem("shole");
			if (parseInt(shole) >= 18){
				$('#endhole').hide();
			}
			$('#distance').attr('placeholder',window.localStorage.getItem("units"));
			
			
			if (window.localStorage.getItem("clubs") == null){
				var sclubs = new Array();
			} else {
				var sclubs = JSON.parse(window.localStorage.getItem("clubs"));
				if (sclubs.length > 0){
					$('#club').empty();
					$(sclubs).each(function(key,value){
						$('#club').append($('<option>', {
							value: value,
							text: value
						}));
					});
				}
			}
			
		});
		$('#prevstrike').click(function(event){
			event.preventDefault();
			$('.app').hide();
			var strike = parseInt(window.localStorage.getItem("strike"));
			if (!(strike > 0)){
				strike = 1;
			}
			//window.localStorage.setItem("strike", strike-1);
			//window.location.href = 'input.html';
			if ( strike > 1){
				recoverStroke(strike-1);
			}
			$('.app').fadeIn('slow');
		});
		$('#nextstrike').click(function(event){
			event.preventDefault();
			
			$.ajax({
				type: 'post',
				cache: false,
				url: 'http://proyectosweb.info/golf/privado/ajax_save_input',
				data: {
					'user_id':window.localStorage.getItem("user_id"),
					'course':window.localStorage.getItem("course"),
					'tour':window.localStorage.getItem("tour"),
					'hole':window.localStorage.getItem("shole"),
					'par':window.localStorage.getItem("par"),
					'strike':window.localStorage.getItem("strike"),
					'distance':parseInt($('#distance').val())*unitT,
					'lie':$('#lie').val(),
					'club':$('#club').val(),
					'prevented':$('#prevented:checked').length,
					'penalty':$('#penalty').val(),
					'lifted':0
				},
				dataType: 'json',
				success: function(response){
					var strike = parseInt(window.localStorage.getItem("strike"));
					if (!(strike > 0)){
						strike = 1;
					}
					window.localStorage.setItem("strike", strike+1);
					window.location.href = 'input.html';
				}
			});
		});
/* $('.sqbtn').click(function(){
			$('.sqbtn').removeClass('selected');
			$(this).addClass('selected');
			window.localStorage.setItem("par", $(this).val());
		}); */
		$('#par').change(function(){
			window.localStorage.setItem("par", $(this).val());
			$('#spar').html($(this).val());
			$("#modalpar").modal("hide");
		});
		$('#endhole').click(function(event){
			event.preventDefault();
			var gt = window.localStorage.getItem("game_type");
			if (gt == 'Stableford'){
				$("#modal1").modal("show");
			} else {
				$.ajax({
					type: 'post',
					cache: false,
					url: 'http://proyectosweb.info/golf/privado/ajax_save_input',
					data: {
						'user_id':window.localStorage.getItem("user_id"),
						'course':window.localStorage.getItem("course"),
						'tour':window.localStorage.getItem("tour"),
						'hole':window.localStorage.getItem("shole"),
						'par':window.localStorage.getItem("par"),
						'strike':window.localStorage.getItem("strike"),
						'distance':parseInt($('#distance').val())*unitT,
						'lie':$('#lie').val(),
						'club':$('#club').val(),
						'prevented':$('#prevented:checked').length,
						'penalty':$('#penalty').val(),
						'lifted':1
					},
					dataType: 'json',
					success: function(response){
						window.localStorage.setItem("strike", 1);
						window.localStorage.setItem("pstrike", 0);
						var shole = parseInt(window.localStorage.getItem("shole"));
						window.localStorage.setItem("shole", shole+1);
						window.location.href = 'input.html';
					}
				});
				
			}
		});
		
		$('#gimme').click(function(event){
			event.preventDefault();
			var gt = window.localStorage.getItem("game_type");
			if (gt == 'Stableford'){
				$("#modal1").modal("show");
			} else {
				$.ajax({
					type: 'post',
					cache: false,
					url: 'http://proyectosweb.info/golf/privado/ajax_save_input',
					data: {
						'user_id':window.localStorage.getItem("user_id"),
						'course':window.localStorage.getItem("course"),
						'tour':window.localStorage.getItem("tour"),
						'hole':window.localStorage.getItem("shole"),
						'par':window.localStorage.getItem("par"),
						'strike':window.localStorage.getItem("strike"),
						'distance':'0.5',
						'lie':'Green',
						'club':'Putter',
						'prevented':$('#prevented:checked').length,
						'penalty':$('#penalty').val(),
						'lifted':1
					},
					dataType: 'json',
					success: function(response){
						window.localStorage.setItem("strike", 1);
						window.localStorage.setItem("pstrike", 0);
						var shole = parseInt(window.localStorage.getItem("shole"));
						window.localStorage.setItem("shole", shole+1);
						window.location.href = 'input.html';
					}
				});
				
			}
		});
		
		
		$('#toholes').click(function(event){
			event.preventDefault();
			var gt = window.localStorage.getItem("game_type");
			if (gt == 'Stableford'){
				$("#modal1").modal("show");
			} else {
				$.ajax({
					type: 'post',
					cache: false,
					url: 'http://proyectosweb.info/golf/privado/ajax_save_input',
					data: {
						'user_id':window.localStorage.getItem("user_id"),
						'course':window.localStorage.getItem("course"),
						'tour':window.localStorage.getItem("tour"),
						'hole':window.localStorage.getItem("shole"),
						'par':window.localStorage.getItem("par"),
						'strike':window.localStorage.getItem("strike"),
						'distance':parseInt($('#distance').val())*unitT,
						'lie':$('#lie').val(),
						'club':$('#club').val(),
						'prevented':$('#prevented:checked').length,
						'penalty':$('#penalty').val(),
						'lifted':1
					},
					dataType: 'json',
					success: function(response){
						window.localStorage.setItem("strike", 1);
						window.localStorage.setItem("pstrike", 0);
						var shole = parseInt(window.localStorage.getItem("shole"));
						window.localStorage.setItem("shole", shole+1);
						window.location.href = 'holes.html';
					}
				});
				
			}
		});
		
		$('#bholed').click(function(event){
			event.preventDefault();
			$("#modal1").modal("hide");
			$.ajax({
				type: 'post',
				cache: false,
				url: 'http://proyectosweb.info/golf/privado/ajax_save_input',
				data: {
					'user_id':window.localStorage.getItem("user_id"),
					'course':window.localStorage.getItem("course"),
					'tour':window.localStorage.getItem("tour"),
					'hole':window.localStorage.getItem("shole"),
					'par':window.localStorage.getItem("par"),
					'strike':window.localStorage.getItem("strike"),
					'distance':parseInt($('#distance').val())*unitT,
					'lie':$('#lie').val(),
					'club':$('#club').val(),
					'prevented':$('#prevented:checked').length,
					'penalty':$('#penalty').val(),
					'lifted':0
				},
				dataType: 'json',
				success: function(response){
					window.localStorage.setItem("strike", 1);
					window.localStorage.setItem("pstrike", 0);
					var shole = parseInt(window.localStorage.getItem("shole"));
					window.localStorage.setItem("shole", shole+1);
					window.location.href = 'input.html';
				}
			});
		});
		$('#blifted').click(function(event){
			event.preventDefault();
			$("#modal1").modal("hide");
			$.ajax({
				type: 'post',
				cache: false,
				url: 'http://proyectosweb.info/golf/privado/ajax_save_input',
				data: {
					'user_id':window.localStorage.getItem("user_id"),
					'course':window.localStorage.getItem("course"),
					'tour':window.localStorage.getItem("tour"),
					'hole':window.localStorage.getItem("shole"),
					'par':window.localStorage.getItem("par"),
					'strike':window.localStorage.getItem("strike"),
					'distance':parseInt($('#distance').val())*unitT,
					'lie':$('#lie').val(),
					'club':$('#club').val(),
					'prevented':$('#prevented:checked').length,
					'penalty':$('#penalty').val(),
					'lifted':1
				},
				dataType: 'json',
				success: function(response){
					window.localStorage.setItem("strike", 1);
					window.localStorage.setItem("pstrike", 0);
					var shole = parseInt(window.localStorage.getItem("shole"));
					window.localStorage.setItem("shole", shole+1);
					window.location.href = 'input.html';
				}
			});
		});
		
		
		$('#endround').click(function(event){
			event.preventDefault();
			$.ajax({
				type: 'post',
				cache: false,
				url: 'http://proyectosweb.info/golf/privado/ajax_save_input',
				data: {
					'user_id':window.localStorage.getItem("user_id"),
					'course':window.localStorage.getItem("course"),
					'tour':window.localStorage.getItem("tour"),
					'hole':window.localStorage.getItem("shole"),
					'par':window.localStorage.getItem("par"),
					'strike':window.localStorage.getItem("strike"),
					'distance':parseInt($('#distance').val())*unitT,
					'lie':$('#lie').val(),
					'club':$('#club').val(),
					'prevented':$('#prevented:checked').length,
					'penalty':$('#penalty').val(),
					'lifted':0
				},
				dataType: 'json',
				success: function(response){
					window.localStorage.removeItem("course");
					window.localStorage.removeItem("shole");
					window.localStorage.removeItem("par");
					window.localStorage.removeItem("strike");
					window.localStorage.removeItem("pstrike");
					window.localStorage.removeItem("wind");
					window.localStorage.removeItem("weather");
					window.localStorage.removeItem("game_type");
					window.localStorage.removeItem("bars");
					window.localStorage.removeItem("lie");
					window.localStorage.removeItem("club");
					window.location.href = 'home.html';
				}
			});
		});
		$('#distance').change(function(){
			//$('.s2').removeClass('disabled');
		});
		$('#lie').change(function(){
			if ($('#lie option:selected').val() == 'Green'){
				$('#club').val('Putter').attr('disabled',true);
			} else {
				$('#club').attr('disabled',false);
			}
			//$('.s3').removeClass('disabled');
			window.localStorage.setItem("lie", $(this).val());
		});
		$('#club').change(function(){
			//$('.s4').removeClass('disabled');
			//$('.s5').removeClass('disabled');
			window.localStorage.setItem("club", $(this).val());
		});
		$('#penalty').change(function(){
			pstrike = window.localStorage.getItem("pstrike");
			window.localStorage.setItem("pstrike", parseInt(pstrike)+parseInt($(this).val()));
			$('h2 em').html('+'+window.localStorage.getItem("pstrike"));
		});
		$('#sd1').click(function(){$('#modal2').modal('hide')})
		$('#sd2').click(function(){$('#modal2').modal('hide')})
		
		function recoverStroke(stroke){
			$.ajax({
				type: 'post',
				cache: false,
				url: 'http://proyectosweb.info/golf/privado/ajax_recover_input',
				data: {
					'user_id':window.localStorage.getItem("user_id"),
					'tour':window.localStorage.getItem("tour"),
					'hole':window.localStorage.getItem("shole"),
					'strike':stroke
				},
				dataType: 'json',
				success: function(response){
					$('#club').val(response.club);
					$('#lie').val(response.lie);
					$('#distance').val(Math.ceil(parseInt(response.distance)*unitT2));
					$('#penalty').val(response.penalty);
					if (response.prevented == 1){
						$('#prevented').prop('checked','checked');
					}
					window.localStorage.setItem("strike",stroke);
					$('h2 span').html(stroke);
					if (parseInt(stroke) == 1){
						$('#prevstrike').hide();
						$('#gimme').hide();
						window.localStorage.setItem("par",0);
						$("#modalpar").modal({show: true,keyboard: false,backdrop: 'static'});
						$('#lie').empty().append($('<option>', {value: 'Teeing',text: 'Tee'})).attr('readonly','readonly');
					}
				}
			});
		}
    </script>
</body>

</html>